
 make.py started: 2021-04-20 16:04:31 C:\Users\diegog\Desktop\Diego\min_wage_rent\base\qcew\code 




Execute:  StataMP-64 /e do "./create_ind_county_quarter_panel.do"

  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   15.1   Copyright 1985-2017 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     MP - Parallel Edition            College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Single-user 32-core Stata perpetual license:
       Serial number:  501506205566
         Licensed to:  KU Leuven FEB (CES)
                       KU Leuven

Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  More than 2 billion observations are allowed; see help obs_advice.
      4.  Maximum number of variables is set to 5000; see help set_maxvar.

. do ./create_ind_county_quarter_panel.do 

. set more off

. clear all

. adopath + ../../../lib/stata/gslab_misc/ado
  [1]  (BASE)      "C:\Program Files\Stata15\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata15\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "c:\ado\personal/"
  [5]  (PLUS)      "c:\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "../../../lib/stata/gslab_misc/ado"

. 
. program main
  1.         local instub "../../../drive/raw_data/qcew/county"
  2.         local outstub "../output"
  3. 
.         foreach year in 09 10 11 12 13 14 15 16 17 18 {
  4.                 process_hl_county_year_file, instub(`instub') year(`year')
  5.         }
  6.         process_hl_county_year_file, instub(`instub') year(19) quarters(3)
  7.         
.         use "../temp/09.dta", clear
  8.         foreach year in 10 11 12 13 14 15 16 17 18 19 {
  9.                 append using "../temp/`year'.dta"
 10.         }
 11.     save_data "`outstub'/industry_county_qtr_emp_wage.dta", ///
>                 key(year quarter countyfips naics ownership) replace
 12. end

. 
. program process_hl_county_year_file
  1.         syntax, instub(str) year(str) [quarters(int 4)]
  2.         
.         forval qtr = 1(1)`quarters' {
  3.                 import excel "`instub'/20`year'_all_county_high_level/allh
> lcn`year'`qtr'.xlsx", ///
>                         sheet("US_St_Cn_MSA") firstrow clear
  4. 
.                 keep if (AreaType == "County")
  5.                 drop Cnty Own StName AreaType StatusCode TotalQuarterlyWag
> es EmploymentLocation TotalWageLocation
  6.                 
.                 destring Year, replace
  7.                 destring Qtr, replace
  8.                 gen end_month = Qtr*3
  9.                 rename (Year Qtr) (year quarter)
 10.                 
.                 rename (AreaCode Area St NAICS Ownership Industry Establishme
> nt AverageWeekly) ///
>                         (countyfips county statefips naics ownership industry
>  estab_count avg_week_wage)
 11.                 
.                 if "`qtr'" == "1" {
 12.                         rename (January February March) ///
>                                 (employment_month1 employment_month2 employme
> nt_month3)
 13.                 }
 14.                 if "`qtr'" == "2" {
 15.                         rename (April May June) ///
>                                 (employment_month1 employment_month2 employme
> nt_month3)
 16.                 }
 17.                 if "`qtr'" == "3" {
 18.                         rename (July August September) ///
>                                 (employment_month1 employment_month2 employme
> nt_month3)
 19.                 }
 20.                 if "`qtr'" == "4" {
 21.                         rename (October November December) ///
>                                 (employment_month1 employment_month2 employme
> nt_month3)
 22.                 }
 23.                 
.                 save "../temp/`year'`qtr'.dta", replace
 24.         }
 25.         
.         use "../temp/`year'1.dta", clear
 26.         forval qtr = 2(1)`quarters' {
 27.                 append using "../temp/`year'`qtr'.dta"
 28.         }
 29.         
.         order year quarter countyfips county statefips ///
>                 naics ownership industry estab_count
 30.         save_data "../temp/`year'.dta", key(year quarter countyfips naics 
> ownership) ///
>                 replace log(none)
 31. end

. 
. * EXECUTE
. main
(7,307 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/091.dta not found)
file ../temp/091.dta saved
(7,294 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/092.dta not found)
file ../temp/092.dta saved
(7,307 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/093.dta not found)
file ../temp/093.dta saved
(7,316 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/094.dta not found)
file ../temp/094.dta saved
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,644,560 bytes saved)
===============================================================================
File: ../temp/09.dta
Key: year quarter countyfips naics ownership
===============================================================================
  220380:14(107643):2969291747:2863215963

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    220,380        2009           0       2009       2009
     quarter |    220,380    2.499782    1.118191          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    220,380    642.9734    4571.916          1     434550
employment~1 |    220,380    8503.494     53766.5          0    4006601
-------------+---------------------------------------------------------
employment~2 |    220,380     8506.11    53748.39          0    3996886
employment~3 |    220,380    8507.563    53764.31          0    3995604
avg_week_w~e |    220,380    619.4603    317.4221          0      13846
   end_month |    220,380    7.499347    3.354572          3         12




(note: file ../temp/09.dta not found)
file ../temp/09.dta saved
(7,310 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/101.dta not found)
file ../temp/101.dta saved
(7,304 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/102.dta not found)
file ../temp/102.dta saved
(7,296 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/103.dta not found)
file ../temp/103.dta saved
(7,281 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/104.dta not found)
file ../temp/104.dta saved
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,641,848 bytes saved)
===============================================================================
File: ../temp/10.dta
Key: year quarter countyfips naics ownership
===============================================================================
  220154:14(107643):1101647976:2266934133

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    220,154        2010           0       2010       2010
     quarter |    220,154    2.499773    1.117915          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    220,154    642.7758    4591.416          1     436362
employment~1 |    220,154    8428.347    53174.05          0    3884250
-------------+---------------------------------------------------------
employment~2 |    220,154    8457.025    53350.55          0    3900311
employment~3 |    220,154    8490.364    53556.23          0    3924685
avg_week_w~e |    220,154    632.9038    323.1783          0      11517
   end_month |    220,154    7.499319    3.353744          3         12




(note: file ../temp/10.dta not found)
file ../temp/10.dta saved
(7,292 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/111.dta not found)
file ../temp/111.dta saved
(7,283 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/112.dta not found)
file ../temp/112.dta saved
(7,283 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/113.dta not found)
file ../temp/113.dta saved
(7,310 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/114.dta not found)
file ../temp/114.dta saved
(note: variable avg_week_wage was int, now long to accommodate using data's
       values)
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,639,052 bytes saved)
===============================================================================
File: ../temp/11.dta
Key: year quarter countyfips naics ownership
===============================================================================
  219921:14(107643):1298866399:3927305804

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    219,921        2011           0       2011       2011
     quarter |    219,921    2.500725    1.118315          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    219,921    649.2678    4709.053          1     445892
employment~1 |    219,921    8547.596    54108.51          0    3913015
-------------+---------------------------------------------------------
employment~2 |    219,921    8583.939    54328.91          0    3936533
employment~3 |    219,921    8622.069     54575.7          0    3955519
avg_week_w~e |    219,921    652.8949    363.0849          0      54857
   end_month |    219,921    7.502176    3.354945          3         12




(note: file ../temp/11.dta not found)
file ../temp/11.dta saved
(7,293 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/121.dta not found)
file ../temp/121.dta saved
(7,284 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/122.dta not found)
file ../temp/122.dta saved
(7,284 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/123.dta not found)
file ../temp/123.dta saved
(7,295 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/124.dta not found)
file ../temp/124.dta saved
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,639,352 bytes saved)
===============================================================================
File: ../temp/12.dta
Key: year quarter countyfips naics ownership
===============================================================================
  219946:14(107643):25177972:142751588

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    219,946        2012           0       2012       2012
     quarter |    219,946    2.500741    1.118118          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    219,946    652.8105    4632.168          1     447826
employment~1 |    219,946    8718.013    55418.84          0    4026545
-------------+---------------------------------------------------------
employment~2 |    219,946    8766.893    55738.04          0    4063815
employment~3 |    219,946    8807.453    56014.12          0    4085523
avg_week_w~e |    219,946    670.3896    351.4186          0      17308
   end_month |    219,946    7.502223    3.354353          3         12




(note: file ../temp/12.dta not found)
file ../temp/12.dta saved
(7,624 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/131.dta not found)
file ../temp/131.dta saved
(7,620 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/132.dta not found)
file ../temp/132.dta saved
(7,629 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/133.dta not found)
file ../temp/133.dta saved
(7,638 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/134.dta not found)
file ../temp/134.dta saved
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,640,468 bytes saved)
===============================================================================
File: ../temp/13.dta
Key: year quarter countyfips naics ownership
===============================================================================
  220039:14(107643):1197641231:582806427

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    220,039        2013           0       2013       2013
     quarter |    220,039    2.500475     1.11801          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    220,039    658.7218    4686.498          1     436911
employment~1 |    220,039      8867.7    56749.69          0    4125818
-------------+---------------------------------------------------------
employment~2 |    220,039    8924.397    57096.69          0    4165043
employment~3 |    220,039    8955.495     57315.1          0    4177944
avg_week_w~e |    220,039    680.8163    349.9487          0      18390
   end_month |    220,039    7.501425     3.35403          3         12




(note: file ../temp/13.dta not found)
file ../temp/13.dta saved
(7,633 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/141.dta not found)
file ../temp/141.dta saved
(7,631 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/142.dta not found)
file ../temp/142.dta saved
(7,633 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/143.dta not found)
file ../temp/143.dta saved
(7,638 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/144.dta not found)
file ../temp/144.dta saved
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,640,036 bytes saved)
===============================================================================
File: ../temp/14.dta
Key: year quarter countyfips naics ownership
===============================================================================
  220003:14(107643):2908699689:1425522602

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    220,003        2014           0       2014       2014
     quarter |    220,003    2.500334    1.118177          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    220,003    670.1204    4828.525          1     445243
employment~1 |    220,003    9068.706    58193.77          0    4200385
-------------+---------------------------------------------------------
employment~2 |    220,003    9120.927    58527.47          0    4228954
employment~3 |    220,003    9158.372    58759.57          0    4244204
avg_week_w~e |    220,003    702.2545    370.7872          0      25295
   end_month |    220,003    7.501002     3.35453          3         12




(note: file ../temp/14.dta not found)
file ../temp/14.dta saved
(7,622 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/151.dta not found)
file ../temp/151.dta saved
(7,626 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/152.dta not found)
file ../temp/152.dta saved
(7,627 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/153.dta not found)
file ../temp/153.dta saved
(7,628 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/154.dta not found)
file ../temp/154.dta saved
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,642,580 bytes saved)
===============================================================================
File: ../temp/15.dta
Key: year quarter countyfips naics ownership
===============================================================================
  220215:14(107643):2434612306:2047800406

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    220,215        2015           0       2015       2015
     quarter |    220,215    2.501342    1.117753          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    220,215    681.0475    4931.969          1     462230
employment~1 |    220,215    9265.175    59592.07          0    4318536
-------------+---------------------------------------------------------
employment~2 |    220,215    9309.992    59870.83          0    4341915
employment~3 |    220,215    9340.821    60071.06          0    4355391
avg_week_w~e |    220,215    721.6516    397.2773          0      50787
   end_month |    220,215    7.504026     3.35326          3         12




(note: file ../temp/15.dta not found)
file ../temp/15.dta saved
(7,624 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/161.dta not found)
file ../temp/161.dta saved
(7,629 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/162.dta not found)
file ../temp/162.dta saved
(7,626 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/163.dta not found)
file ../temp/163.dta saved
(7,627 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/164.dta not found)
file ../temp/164.dta saved
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,644,080 bytes saved)
===============================================================================
File: ../temp/16.dta
Key: year quarter countyfips naics ownership
===============================================================================
  220340:14(107643):675960281:360358300

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    220,340        2016           0       2016       2016
     quarter |    220,340    2.500399    1.117947          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    220,340    694.7188    5056.566          1     470304
employment~1 |    220,340    9426.713    60884.55          0    4378570
-------------+---------------------------------------------------------
employment~2 |    220,340    9464.254    61124.88          0    4406325
employment~3 |    220,340    9490.236    61248.68          0    4416052
avg_week_w~e |    220,340    728.3092    364.3808          0       9231
   end_month |    220,340    7.501198    3.353841          3         12




(note: file ../temp/16.dta not found)
file ../temp/16.dta saved
(7,627 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/171.dta not found)
file ../temp/171.dta saved
(7,627 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/172.dta not found)
file ../temp/172.dta saved
(7,625 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/173.dta not found)
file ../temp/173.dta saved
(7,622 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/174.dta not found)
file ../temp/174.dta saved
(note: variable avg_week_wage was int, now long to accommodate using data's
       values)
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,644,752 bytes saved)
===============================================================================
File: ../temp/17.dta
Key: year quarter countyfips naics ownership
===============================================================================
  220396:14(107643):853006761:3751443185

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    220,396        2017           0       2017       2017
     quarter |    220,396    2.500172    1.118037          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    220,396    703.1683    5163.079          1     492452
employment~1 |    220,396    9563.931    61754.95          0    4429315
-------------+---------------------------------------------------------
employment~2 |    220,396    9613.746    62101.02          0    4457618
employment~3 |    220,396    9642.845    62236.87          0    4468712
avg_week_w~e |    220,396    751.6612    427.1167          0      94778
   end_month |    220,396    7.500517     3.35411          3         12




(note: file ../temp/17.dta not found)
file ../temp/17.dta saved
(7,624 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/181.dta not found)
file ../temp/181.dta saved
(7,622 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/182.dta not found)
file ../temp/182.dta saved
(7,626 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/183.dta not found)
file ../temp/183.dta saved
(7,632 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/184.dta not found)
file ../temp/184.dta saved
(note: variable avg_week_wage was int, now long to accommodate using data's
       values)
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (2,643,852 bytes saved)
===============================================================================
File: ../temp/18.dta
Key: year quarter countyfips naics ownership
===============================================================================
  220321:14(107643):386314703:1481404477

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    220,321        2018           0       2018       2018
     quarter |    220,321     2.50032    1.118108          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    220,321    716.1449    5292.265          1     506016
employment~1 |    220,321    9730.466     62858.5          0    4484785
-------------+---------------------------------------------------------
employment~2 |    220,321    9786.635    63251.24          0    4528403
employment~3 |    220,321    9809.813    63362.92          0    4526194
avg_week_w~e |    220,321    776.9257      577.59          0     196538
   end_month |    220,321     7.50096    3.354323          3         12




(note: file ../temp/18.dta not found)
file ../temp/18.dta saved
(7,620 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/191.dta not found)
file ../temp/191.dta saved
(7,620 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/192.dta not found)
file ../temp/192.dta saved
(7,610 observations deleted)
Year: all characters numeric; replaced as int
Qtr: all characters numeric; replaced as byte
(note: file ../temp/193.dta not found)
file ../temp/193.dta saved
(data now sorted by year quarter countyfips naics ownership)
  variable end_month was float now byte
  variable county was str50 now str41
  (1,980,972 bytes saved)
===============================================================================
File: ../temp/19.dta
Key: year quarter countyfips naics ownership
===============================================================================
  165081:14(107643):1688648678:2633614947

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |    165,081        2019           0       2019       2019
     quarter |    165,081    2.000127    .8164434          1          3
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |    165,081    730.4515    5397.665          1     509547
employment~1 |    165,081    9835.245    63690.78          0    4477989
-------------+---------------------------------------------------------
employment~2 |    165,081     9886.29     64040.5          0    4505360
employment~3 |    165,081    9911.189    64136.35          0    4511854
avg_week_w~e |    165,081    783.2374    403.1374          0      23770
   end_month |    165,081    6.000382     2.44933          3          9




(note: file ../temp/19.dta not found)
file ../temp/19.dta saved
(note: variable avg_week_wage was int, now long to accommodate using data's
       values)
(note: variable industry was str36, now str41 to accommodate using data's
       values)
(data now sorted by year quarter countyfips naics ownership)
  (0 bytes saved)
===============================================================================
File: ../output/industry_county_qtr_emp_wage.dta
Key: year quarter countyfips naics ownership
===============================================================================
  2366796:14(107643):744045364:1634630812

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |  2,366,796    2013.884    3.104895       2009       2019
     quarter |  2,366,796    2.465512    1.107063          1          4
  countyfips |          0
       naics |          0
   ownership |          0
-------------+---------------------------------------------------------
      county |          0
   statefips |          0
    industry |          0
 estab_count |  2,366,796    675.3197    4892.522          1     509547
employment~1 |  2,366,796    9069.606    58184.55          0    4484785
-------------+---------------------------------------------------------
employment~2 |  2,366,796    9111.654    58458.32          0    4528403
employment~3 |  2,366,796    9140.466    58627.54          0    4526194
avg_week_w~e |  2,366,796    699.9843    395.1676          0     196538
   end_month |  2,366,796    7.396537     3.32119          3         12




(note: file ../output/industry_county_qtr_emp_wage.dta not found)
file ../output/industry_county_qtr_emp_wage.dta saved

. 
end of do-file


Execute:  StataMP-64 /e do "./make_county_month_panel.do"

  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   15.1   Copyright 1985-2017 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     MP - Parallel Edition            College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Single-user 32-core Stata perpetual license:
       Serial number:  501506205566
         Licensed to:  KU Leuven FEB (CES)
                       KU Leuven

Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  More than 2 billion observations are allowed; see help obs_advice.
      4.  Maximum number of variables is set to 5000; see help set_maxvar.

. do ./make_county_month_panel.do 

. set more off

. clear all

. adopath + ../../../lib/stata/gslab_misc/ado
  [1]  (BASE)      "C:\Program Files\Stata15\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata15\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "c:\ado\personal/"
  [5]  (PLUS)      "c:\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "../../../lib/stata/gslab_misc/ado"

. 
. program main 
  1.     local instub "../output"
  2.     local outstub "../output"
  3. 
.     use `instub'/industry_county_qtr_emp_wage.dta, clear
  4. 
.     select_sectors, ownership(`" "Total Covered" "') industries("10")
  5.     clean_vars
  6.     create_monthly_panel
  7.     save_data `outstub'/tot_emp_wage_countymonth.dta, ///
>         key(countyfips year month) replace
  8. 
.     use `instub'/industry_county_qtr_emp_wage.dta, clear
  9.     select_sectors, ownership(`""Federal Government" "State Government" "L
> ocal Government" "Private""') ///
>                     industries("1011 1012 1013 1021 1022 1023 1024 1025 1026 
> 1019")
 10.     clean_vars
 11.     create_monthly_panel
 12.     save_data `outstub'/ind_emp_wage_countymonth.dta, ///
>         key(countyfips year month) replace 
 13. 
. end 

. 
. program select_sectors
  1.     syntax, ownership(str) industries(str)
  2. 
.     local n : word count `ownership'
  3.     local first_owner: word 1 of `ownership'
  4.     local owner_list `"ownership=="`first_owner'""'
  5.     
.     if `n'>1 {
  6.         forval x = 2/`n' {
  7.             local this_owner: word `x' of `ownership'
  8.             local this_owner_list `" | ownership== "`this_owner'""'
  9.             local owner_list `"`owner_list' `this_owner_list'"'    
 10.         }        
 11.     }
 12.     keep if `owner_list'
 13. 
.     replace industry = trim(regexr(trim(industry), "^[0-9]+", ""))
 14. 
.     local n : word count `industries'
 15.     local first_ind: word 1 of `industries'
 16.     local ind_list `"naics == "`first_ind'""'
 17.     
.     if `n'>1 {
 18.         forval x = 2/`n' {
 19.             local this_ind: word `x' of `industries'
 20.             local this_ind_list `" | naics == "`this_ind'""'
 21.             local ind_list `"`ind_list' `this_ind_list'"'    
 22.         }        
 23.     }
 24.     keep if (ownership != "Private") |  (ownership== "Private" & (`ind_lis
> t'))
 25. 
.     replace industry = ownership if ownership!= "Private"
 26. end

. 
. program clean_vars 
  1.     drop naics ownership county 
  2. 
.     rename (employment_month1 employment_month2 employment_month3 estab_count
>  avg_week_wage) ///
>            (emp_1             emp_2             emp_3             estcount_  
>  avgwwage_)
  3. 
.     replace industry = "const"   if industry == "Construction"
  4.     replace industry = "eduhe"   if industry == "Education and health serv
> ices"
  5.     replace industry = "fedgov"  if industry == "Federal Government"
  6.     replace industry = "goodpr"  if industry == "Goods-producing"
  7.     replace industry = "info"    if industry == "Information"
  8.     replace industry = "leis"    if industry == "Leisure and hospitality"
  9.     replace industry = "manu"    if industry == "Manufacturing"
 10.     replace industry = "natres"  if industry == "Natural resources and min
> ing"
 11.     replace industry = "bizserv" if industry == "Professional and business
>  services"
 12.     replace industry = "servpr"  if industry == "Service-providing"
 13.     replace industry = "stgov"   if industry == "State Government"
 14.     replace industry = "transp"  if industry == "Trade, transportation, an
> d utilities"
 15.     replace industry = "locgov"  if industry == "Local Government"
 16.     replace industry = "fin"     if industry == "Financial activities"
 17.     replace industry = "tot"     if industry == "Total Covered"
 18. end  

. 
. 
. program  create_monthly_panel
  1.     
.     reshape long emp_, ///
>             i(year quarter countyfips statefips industry estcount avgwwage) /
> //
>                 j(qmon)
  2. 
.     replace qmon = qmon + 3 if quarter == 2
  3.     replace qmon = qmon + 6 if quarter == 3
  4.     replace qmon = qmon + 9 if quarter == 4
  5. 
.     gen month = qmon
  6.     order year month, after(countyfips)
  7. 
.     reshape wide estcount avgwwage emp, i(countyfips statefips year month) //
> /
>             j(industry) string
  8. 
. end 

. 
. 
. main 
(2,229,631 observations deleted)
(35,094 real changes made)
(0 observations deleted)
(137,165 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(137,165 real changes made)
(note: j = 1 2 3)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                   137165   ->  411495
Number of variables                  11   ->      10
j variable (3 values)                     ->   qmon
xij variables:
                      emp_1 emp_2 emp_3   ->   emp_
-----------------------------------------------------------------------------
(105,264 real changes made)
(105,267 real changes made)
(95,694 real changes made)
(note: j = tot)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                   411495   ->  411495
Number of variables                  11   ->      10
j variable (1 values)          industry   ->   (dropped)
xij variables:
                              estcount_   ->   estcount_tot
                              avgwwage_   ->   avgwwage_tot
                                   emp_   ->   emp_tot
-----------------------------------------------------------------------------
(data now sorted by countyfips year month)
  variable month was float now byte
  variable avgwwage_tot was long now int
  (2,057,475 bytes saved)
===============================================================================
File: ../output/tot_emp_wage_countymonth.dta
Key: countyfips year month
===============================================================================
  411495:10(75043):1461590029:1184845544

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  countyfips |          0
        year |    411,495    2013.884    3.104633       2009       2019
       month |    411,495     6.39529    3.420013          1         12
   statefips |          0
estcount_tot |    411,495    2959.739    11475.88          1     509547
-------------+---------------------------------------------------------
avgwwage_tot |    411,495     730.277    196.2662          0       4317
     emp_tot |    411,495    42865.84    150690.1          0    4528403
     quarter |    411,495    2.465097    1.107039          1          4
        qmon |    411,495     6.39529    3.420013          1         12
   end_month |    411,495     7.39529    3.321117          3         12




(note: file ../output/tot_emp_wage_countymonth.dta not found)
file ../output/tot_emp_wage_countymonth.dta saved
(137,165 observations deleted)
(570,704 real changes made)
(598,432 observations deleted)
(407,581 real changes made)
(136,659 real changes made)
(136,436 real changes made)
(137,092 real changes made)
(0 real changes made)
(132,614 real changes made)
(136,782 real changes made)
(134,566 real changes made)
(135,918 real changes made)
(136,790 real changes made)
(0 real changes made)
(134,025 real changes made)
(137,130 real changes made)
(136,464 real changes made)
(136,723 real changes made)
(0 real changes made)
(note: j = 1 2 3)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                  1.6e+06   -> 4.9e+06
Number of variables                  11   ->      10
j variable (3 values)                     ->   qmon
xij variables:
                      emp_1 emp_2 emp_3   ->   emp_
-----------------------------------------------------------------------------
(1,251,822 real changes made)
(1,251,807 real changes made)
(1,138,125 real changes made)
(note: j = bizserv const eduhe fedgov fin info leis locgov manu natres stgov tr
> ansp)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                  4.9e+06   ->  411495
Number of variables                  11   ->      43
j variable (12 values)         industry   ->   (dropped)
xij variables:
                              estcount_   ->   estcount_bizserv estcount_const 
> ... estcount_transp
                              avgwwage_   ->   avgwwage_bizserv avgwwage_const 
> ... avgwwage_transp
                                   emp_   ->   emp_bizserv emp_const ... emp_tr
> ansp
-----------------------------------------------------------------------------
(data now sorted by countyfips year month)
  variable month was float now byte
  variable avgwwage_bizserv was long now int
  variable estcount_const was long now int
  variable avgwwage_const was long now int
  variable avgwwage_eduhe was long now int
  variable estcount_fedgov was long now int
  variable avgwwage_fedgov was long now int
  variable estcount_fin was long now int
  variable avgwwage_fin was long now int
  variable estcount_info was long now int
  variable avgwwage_info was long now int
  variable avgwwage_leis was long now int
  variable estcount_locgov was long now int
  variable avgwwage_locgov was long now int
  variable estcount_manu was long now int
  variable avgwwage_manu was long now int
  variable estcount_natres was long now int
  variable avgwwage_natres was long now int
  variable estcount_stgov was long now int
  variable avgwwage_stgov was long now int
  variable avgwwage_transp was long now int
  (17,694,285 bytes saved)
===============================================================================
File: ../output/ind_emp_wage_countymonth.dta
Key: countyfips year month
===============================================================================
  411495:43(65860):1386539646:221802420

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  countyfips |          0
        year |    411,495    2013.884    3.104633       2009       2019
       month |    411,495     6.39529    3.420013          1         12
   statefips |          0
estcount_b~v |    410,370    527.7828    1943.401          1      56304
-------------+---------------------------------------------------------
avgwwage_b~v |    410,370    755.5147    392.7518          0      26956
 emp_bizserv |    410,370    5850.595    26024.48          0     642234
estcount_c~t |    409,977    245.3518     650.716          1      16939
avgwwage_c~t |    409,977    741.5846    354.5943          0       8024
   emp_const |    409,977    1932.697    6535.075          0     173773
-------------+---------------------------------------------------------
estcount_e~e |    409,308     420.143    3419.999          1     245645
avgwwage_e~e |    409,308    641.3074    229.8115          0      14008
   emp_eduhe |    409,308    6461.037    23784.17          0     835039
estcount_f~v |    411,276    19.62766    24.95878          1        456
avgwwage_f~v |    411,276    1046.298    271.6712          0       7519
-------------+---------------------------------------------------------
  emp_fedgov |    411,276    882.6995    4677.256          0     215436
estcount_fin |    410,169    265.3766     953.134          1      30238
avgwwage_fin |    410,169    820.1979    381.8705          0      12775
     emp_fin |    410,169    2421.552    11617.31          0     398481
estcount_i~o |    397,842    49.89478    246.7007          1      13212
-------------+---------------------------------------------------------
avgwwage_i~o |    397,842    688.8703    505.9362          0      16227
    emp_info |    397,842    882.7266    5715.506          0     240358
estcount_l~s |    410,346    250.4443    883.9033          1      39222
avgwwage_l~s |    410,346    276.3337    146.6109          0      14060
    emp_leis |    410,346    4582.501    17129.03          0     551791
-------------+---------------------------------------------------------
estcount_l~v |    409,392     52.4585    104.7181          1       4162
avgwwage_l~v |    409,392     614.938    262.6563          0       2895
  emp_locgov |    409,392    4187.274     14639.1          0     477250
estcount_m~u |    403,698    109.5934    372.0323          1      14161
avgwwage_m~u |    403,698    815.0727      419.84          0       7592
-------------+---------------------------------------------------------
    emp_manu |    403,698    3839.497    12026.26          0     407291
estcount_n~s |    407,754    42.27518    86.18449          1       1905
avgwwage_n~s |    407,754    734.6683    449.4012          0      23770
  emp_natres |    407,754    596.7103    2769.521          0      97846
estcount_s~v |    402,075    21.81536    107.6615          1       6080
-------------+---------------------------------------------------------
avgwwage_s~v |    402,075    739.5306    329.6563          0       4279
   emp_stgov |    402,075    1356.364    5055.118          0     115630
estcount_t~p |    411,390    596.5829    1867.797          1      59438
avgwwage_t~p |    411,390     656.642    224.0343          0      11257
  emp_transp |    411,390    8144.131    27862.22          0     872187
-------------+---------------------------------------------------------
     quarter |    411,495    2.465097    1.107039          1          4
        qmon |    411,495     6.39529    3.420013          1         12
   end_month |    411,495     7.39529    3.321117          3         12




(note: file ../output/ind_emp_wage_countymonth.dta not found)
file ../output/ind_emp_wage_countymonth.dta saved

. 
end of do-file

 make.py ended: 2021-04-20 16:19:19
