---
title: "Long-run effect"
author: "MW-rents"
date: "12/14/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Simplifying notation a bit and neglecting controls and time-period effects, the 
model is

$$ y_{t} = \alpha + \gamma y_{t-1} 
          + \sum_{r=0}^s \beta_r w_{t} + \epsilon_{t} $$
for some window $s$. First-differencing, we get 
$$ \Delta y_{t} = \gamma \Delta y_{t-1} 
                + \sum_{r=0}^s \beta_r \Delta w_{t} + \Delta \epsilon_{t} $$

## Initial equilibrium

Consider a long-run equilibrium with some exogenous level $w_{it} = \bar{w}$ and
no shocks. The long-run outcome variable will be 

$$ \bar{y} = \sum_{r=0}^s \beta_r \bar{w} + \gamma \bar{y} 
  \implies \bar{y} = \frac{\sum_{r=0}^s \beta_r}{1-\gamma} \bar{w} $$

To make the math easy, we consider $\bar{w} = 1$, so that 

$$ \bar{y} = \frac{\sum_{r=0}^s \beta_r}{1-\gamma} $$

We let $y_0 = \bar{y}$ in the exploration below.

## Simulation: model in levels

Long run equilibrium and parameters are below

```{r}
gamma <- 0.4
b0 <- 0.3
b1 <- 0.1
b2 <- 0.1
b3 <- 0

w_bar <- 1

y_bar <- (b0 + b1 + b2 + b3)/(1-gamma)
```


We now increase the MW by 1 unit and simulate the trajectory of $y$ under the assumption
of no shocks.

```{r}
n = 20

y <- rep(y_bar, n + 4)
w <- rep(w_bar, n + 4)

for (i in seq(4, n + 4)) { # index 4 is period zero
  w[i] <- w_bar + 1
  y[i] <- gamma*y[i-1] + b0*w[i] + b1*w[i-1] + b2*w[i-2] + b3*w[i-3]
}

plot(seq(-3, n), y, xlab = "Time period")
abline(v = 0)
```

The long run effect is 
```{r}
y[length(y)] - y_bar
```

which corresponds to $\frac{\sum_{r=0}^s \beta_r}{1-\gamma}$
```{r}
(b0 + b1 + b2)/(1-gamma)
```


## Simulation: model in first-differences
```{r}
n = 20

dy <- rep(0, n + 4)  # Initially the df is zero
dw <- rep(0, n + 4)

for (i in seq(4, n + 4)) { # index 4 is period zero
  if (i == 4) dw[i] <- 1    # Increase in first period
  else        dw[i] <- 0
  
  dy[i] <- gamma*dy[i-1] + b0*dw[i] + b1*dw[i-1] + b2*dw[i-2] + b3*dw[i-3]
}

plot(seq(-3, n), dy, xlab = "Time period")
abline(v = 0)
```

The long run effect on $y$ is given by the sum of the differences:
```{r}
sum(dy)
```

which is again equal to $\frac{\sum_{r=0}^s \beta_r}{1-\gamma}$.



<!-- ## Shock to the MW and long-run effect -->


<!-- Start time at $t=0$ with the situation described above. Suppose that -->

<!-- $$ w_{1} = 2 \ \ \ \ \text{so} \ \ \ \ \Delta w_1 = 2 - \bar{w} = 1$$ -->
<!-- and set $s = 3$ to simplify. -->

<!-- Computing the values of $y$ and $\Delta y$ in each period we have -->

<!-- | time |  $y_t$                                        |  $\Delta y_t$   | -->
<!-- | ---  | ---                                           | ---             | -->
<!-- | 0    | $y_0$                                         | 0               | -->
<!-- | 1    | $\gamma y_0   + \beta_1 2$                    | $(\gamma - 1) y_0 + \beta_1 2$ | -->
<!-- | 2    | $\gamma^2 y_0 + \gamma \beta_1 2 + \beta_2 2$ | $\gamma(\gamma - 1) y_0 + (\gamma - 1)\beta_1 2 + \beta_2 2$ | -->
<!-- | 3    | $\gamma^3 y_0 + \gamma^2 \beta_1 2 + \gamma \beta_2 2 + \beta_3 2$ | $\gamma(\gamma - 1) y_0 + (\gamma - 1)\beta_1 2 + (\gamma - 1)\beta_2 2 + \beta_3 2$ | -->





