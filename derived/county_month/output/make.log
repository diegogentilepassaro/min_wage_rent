
 make.py started: 2021-04-04 14:28:01 C:\Users\diegog\Desktop\Diego\min_wage_rent\derived\county_month\code 




Execute:  StataMP-64 /e do "./build_county_month_panel.do"

  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   15.1   Copyright 1985-2017 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     MP - Parallel Edition            College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Single-user 32-core Stata perpetual license:
       Serial number:  501506205566
         Licensed to:  KU Leuven FEB (CES)
                       KU Leuven

Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  More than 2 billion observations are allowed; see help obs_advice.
      4.  Maximum number of variables is set to 5000; see help set_maxvar.

. do ./build_county_month_panel.do 

. set more off

. clear all

. adopath + ../../../lib/stata/gslab_misc/ado
  [1]  (BASE)      "C:\Program Files\Stata15\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata15\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "c:\ado\personal/"
  [5]  (PLUS)      "c:\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "../../../lib/stata/gslab_misc/ado"

. adopath + ../../../lib/stata/mental_coupons/ado
  [1]  (BASE)      "C:\Program Files\Stata15\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata15\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "c:\ado\personal/"
  [5]  (PLUS)      "c:\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "../../../lib/stata/gslab_misc/ado"
  [8]              "../../../lib/stata/mental_coupons/ado"

. 
. program main
  1.         local instub_derived  "../../../drive/derived_large"
  2.         local instub_geo  "../../../base/geo_master/output"
  3.         local instub_base  "../../../drive/base_large"
  4.         local instub_qcew "../../../base/qcew/output"
  5.         local outstub "../../../drive/derived_large/county_month"
  6.         local logfile "../output/data_file_manifest.log"
  7. 
.         use countyfips statefips cbsa10 ///
>             using "`instub_geo'/zip_county_place_usps_all.dta", clear
  8.     duplicates drop
  9.         isid countyfips
 10. 
.         destring countyfips, replace
 11.     merge 1:m countyfips using "`instub_derived'/min_wage/county_statutory
> _mw.dta", ///
>            nogen assert(3) keepusing(year month actual_mw_wg_mean ///
>            actual_mw_ignore_local_wg_mean local_mw county_mw fed_mw state_mw 
> ///
>            actual_mw binding_mw actual_mw_ignore_local binding_mw_ignore_loca
> l)
 12.            
.         tostring countyfips, replace
 13.     merge 1:1 countyfips year month using "`instub_base'/zillow/zillow_cou
> nty_clean.dta"
 14.         qui sum medrentpricepsqft_SFCC if _merge == 2 & inrange(year, 2010
> , 2019)       
 15.         *assert r(N) == 0 /* This assertion fails and it should't. We are 
> loosing counties with Zillow data.*/
.         /* Among the _merge == 2 I found pretty important counties like Sacra
> mento, New Haven, or New London. */
.         /* I wonder why they are not in our geo master? */
.         keep if inlist(_merge, 1, 3)
 16.         drop _merge
 17.         
. 
.         /* Should we build experienced MW data by county? Probably we should!
>  */
.         
.         /* Should we build ACS population by county-year? Probably we should!
>  */
. 
.     add_dates
 18.         merge m:1 statefips countyfips year_month ///
>             using "`instub_qcew'/ind_emp_wage_countymonth.dta", nogen keep(1 
> 3)
 19. 
.         strcompress
 20.         save_data "`outstub'/county_month_panel.dta", replace ///
>             key(countyfips year month) log(`logfile')
 21. end

. 
. program add_dates
  1.     gen day = 1
  2.         gen date = mdy(month, day, year)
  3.         gen year_month = mofd(date)
  4.         format year_month %tm
  5.         gen year_quarter = qofd(date)
  6.         format year_quarter %tq
  7.         drop day date
  8. end

. 
. main

Duplicates in terms of all variables

(84,656 observations deleted)
countyfips: all characters numeric; replaced as long

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           377,160  
    -----------------------------------------
countyfips was long now str5

    Result                           # of obs.
    -----------------------------------------
    not matched                       316,320
        from master                   304,320  (_merge==1)
        from using                     12,000  (_merge==2)

    matched                            72,840  (_merge==3)
    -----------------------------------------
(12,000 observations deleted)

    Result                           # of obs.
    -----------------------------------------
    not matched                        46,653
        from master                    46,653  
        from using                          0  

    matched                           330,507  
    -----------------------------------------
  Converting str to strL: countyfips cbsa10 statefips
    strcompress grew data 36% so far, but I'm not done yet!
  variable year_month was float now int
  variable year_quarter was float now int
  variable estcount_eduhe was long now int
  variable estcount_leis was long now int
  variable estcount_transp was long now int
  variable year was double now int
  variable month was double now byte
  variable binding_mw was double now byte
  variable binding_mw_ignore_local was double now byte
  variable countyfips was strL now str5
  variable cbsa10 was strL now str5
  variable statefips was strL now str2
  (62,066,945 bytes saved)
       compress shrank data 38%
    strcompress shrank data 16% overall
(data now sorted by countyfips year month)
  (0 bytes saved)
===============================================================================
File: ../../../drive/derived_large/county_month/county_month_panel.dta
Key: countyfips year month
===============================================================================
  377160:55(40555):2969063559:3619104413

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  countyfips |          0
        year |    377,160      2014.5    2.872285       2010       2019
       month |    377,160         6.5    3.452057          1         12
      cbsa10 |          0
   statefips |          0
-------------+---------------------------------------------------------
ac~w_wg_mean |    377,160    7.680875    .8363347       7.25      15.59
ac~l_wg_mean |    377,160    7.675621    .8175474       7.25         14
    local_mw |      1,440    9.620424    2.276156       7.25      15.59
   county_mw |      1,080     8.81763    1.679736       7.25      14.25
      fed_mw |    377,160        7.25           0       7.25       7.25
-------------+---------------------------------------------------------
    state_mw |    377,160    7.675621    .8175474       7.25         14
   actual_mw |    377,160    7.679514     .832245       7.25      15.59
  binding_mw |    377,160    1.340269    .4813838          1          4
actual_mw_~l |    377,160    7.675621    .8175474       7.25         14
binding_mw~l |    377,160    1.337456    .4728426          1          2
-------------+---------------------------------------------------------
medrentpri~C |     48,046    .9905583    .6107603   .4472472   17.05931
medrentpri~F |     45,389    .9557977    .5742129   .4589161   17.14286
  year_month |    377,160       659.5    34.63986        600        719
year_quarter |    377,160       219.5    11.54341        200        239
estcount_b~v |    329,583    429.1483    1571.186          1      34025
-------------+---------------------------------------------------------
avgwwage_b~v |    329,583    755.9078    379.1463          0      18319
 emp_bizserv |    329,583    5115.673    22828.93          0     628402
estcount_c~t |    329,250    218.8884    563.3732          1      13237
avgwwage_c~t |    329,250    742.2838    347.6449          0       8024
   emp_const |    329,250    1738.463    5608.742          0     173773
-------------+---------------------------------------------------------
estcount_e~e |    328,749    307.7077    986.5564          1      26781
avgwwage_e~e |    328,749    642.3215    217.7239          0       2749
   emp_eduhe |    328,749    6026.034       20112          0     454060
estcount_f~v |    330,354    18.47239    22.58476          1        353
avgwwage_f~v |    330,354     1042.88    262.3209          0       3704
-------------+---------------------------------------------------------
  emp_fedgov |    330,354    823.6762    4716.928          0     215436
estcount_fin |    329,409    232.0452    798.4992          1      19733
avgwwage_fin |    329,409    819.5349    354.7289          0      12775
     emp_fin |    329,409    2193.148    10784.27          0     398481
estcount_i~o |    318,828    38.12644    154.9731          1       5212
-------------+---------------------------------------------------------
avgwwage_i~o |    318,828    670.9182    476.1013          0      16227
    emp_info |    318,828      724.88    4347.341          0     184893
estcount_l~s |    329,457    227.1236    668.9312          1      15078
avgwwage_l~s |    329,457    269.5364      95.184          0       2473
    emp_leis |    329,457    4213.984    14389.57          0     314691
-------------+---------------------------------------------------------
estcount_l~v |    330,507    48.48566    70.70069          2       1123
avgwwage_l~v |    330,507     616.325    256.9099          0       2042
  emp_locgov |    330,507    3763.722    11677.57          0     405432
estcount_m~u |    324,273    95.69214    262.5778          1       6712
avgwwage_m~u |    324,273    820.9481    397.9647          0       7592
-------------+---------------------------------------------------------
    emp_manu |    324,273    3563.175    9214.292          0     201803
estcount_n~s |    327,792    37.43609    65.75315          1       1859
avgwwage_n~s |    327,792      739.04    429.6333          0      23770
  emp_natres |    327,792     468.813    1921.037          0      97846
estcount_s~v |    323,232    17.83719    28.30593          1        602
-------------+---------------------------------------------------------
avgwwage_s~v |    323,232    742.8602    323.3326          0       4279
   emp_stgov |    323,232    1229.694    4431.295          0      68955
estcount_t~p |    330,435    510.0362     1492.63          1      31596
avgwwage_t~p |    330,435    648.3023    183.6151          0      11257
  emp_transp |    330,435    7377.035       23023          0     491699




(note: file ../../../drive/derived_large/county_month/county_month_panel.dta no
> t found)
file ../../../drive/derived_large/county_month/county_month_panel.dta saved

. 
end of do-file

 make.py ended: 2021-04-04 14:28:11
