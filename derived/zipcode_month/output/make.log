
 make.py started: 2021-10-24 08:17:10 C:\Users\diegog\Desktop\Diego\min_wage_rent\derived\zipcode_month\code 




Execute:  StataMP-64 /e do "./build.do"

  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   15.1   Copyright 1985-2017 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     MP - Parallel Edition            College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Single-user 32-core Stata perpetual license:
       Serial number:  501506205566
         Licensed to:  KU Leuven FEB (CES)
                       KU Leuven

Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  More than 2 billion observations are allowed; see help obs_advice.
      4.  Maximum number of variables is set to 5000; see help set_maxvar.

. do ./build.do 

. set more off

. clear all

. adopath + ../../../lib/stata/gslab_misc/ado
  [1]  (BASE)      "C:\Program Files\Stata15\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata15\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "c:\ado\personal/"
  [5]  (PLUS)      "c:\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "../../../lib/stata/gslab_misc/ado"

. adopath + ../../../lib/stata/mental_coupons/ado
  [1]  (BASE)      "C:\Program Files\Stata15\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata15\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "c:\ado\personal/"
  [5]  (PLUS)      "c:\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "../../../lib/stata/gslab_misc/ado"
  [8]              "../../../lib/stata/mental_coupons/ado"

. 
. program main
  1.     local in_der_large  "../../../drive/derived_large"
  2.     local in_geo        "../../../base/geo_master/output"
  3.     local in_base_large "../../../drive/base_large"
  4.     local in_qcew       "../../../base/qcew/output"
  5.     local outstub       "../../../drive/derived_large/zipcode_month"
  6.     local logfile       "../output/data_file_manifest.log"
  7. 
.     use zipcode place_code countyfips cbsa10 zcta statefips rural            
>  ///
>         using "`in_geo'/zip_county_place_usps_master.dta", clear
  8. 
.     merge 1:m zipcode using "`in_der_large'/min_wage/zip_statutory_mw.dta",  
>  ///
>        nogen assert(3) keepusing(year month actual* binding*)
  9.     
.     merge_zillow, instub("`in_base_large'/zillow")
 10.     
.     merge_exp_mw, instub("`in_der_large'/min_wage")
 11.     
.     make_date_variables
 12. 
.     merge m:1 statefips countyfips year month                                
> ///
>         using "`in_qcew'/ind_emp_wage_countymonth.dta", nogen keep(1 3)
 13.     drop qmon end_month
 14. 
.     strcompress
 15.     save_data "`outstub'/zipcode_month_panel.dta", replace ///
>         key(zipcode year month) log(`logfile')
 16.     export delimited "`outstub'/zipcode_month_panel.csv", replace
 17. end

. 
. program merge_zillow
  1.     syntax, instub(str)
  2.     
.     merge 1:1 zipcode year month using "`instub'/zillow_zipcode_clean.dta"
  3. 
.     qui sum medrentpricepsqft_SFCC if _merge == 2 & inrange(year, 2010, 2019)
>     
  4.     assert r(N) == 0
  5.     keep if inlist(_merge, 1, 3)
  6.     drop _merge
  7. end

. 
. program merge_exp_mw
  1.     syntax, instub(str)
  2. 
.     foreach year in 10 14 17 18 {
  3.         merge 1:1 zipcode year month using "`instub'/zipcode_experienced_m
> w_20`year'.dta", ///
>             nogen keep(1 3) keepusing(exp*)
  4.         if `year' == 10 {
  5.             describe exp*, varlist
  6.             local vars = r(varlist)
  7.         }
  8.         foreach var of local vars {
  9.             rename `var' `var'_`year'
 10.         }
 11.         drop *mean_`year'
 12.     }
 13. 
.     qui sum medrentpricepsqft_SFCC if !missing(medrentpricepsqft_SFCC)
 14.     local observations_with_rents = r(N)
 15. 
.     foreach year in 10 14 17 18 {
 16.         sum exp_ln_mw_tot_`year' if !missing(medrentpricepsqft_SFCC)
 17.         assert r(N) == `observations_with_rents'
 18.     }
 19.     
.     foreach year in 11 12 13 15 16 {
 20.         merge 1:1 zipcode year month using "`instub'/zipcode_experienced_m
> w_20`year'.dta", ///
>             nogen keep(1 3) keepusing(exp_ln_mw_tot)
 21.         
.         rename exp_ln_mw_tot exp_ln_mw_tot_`year'
 22.     }
 23. end

. 
. program make_date_variables
  1.     gen day = 1
  2.     gen date = mdy(month, day, year)
  3. 
.     gen    year_month = mofd(date)
  4.     format year_month %tm
  5. 
.     gen    quarter      = quarter(dofm(year_month))
  6.     gen    year_quarter = qofd(date)
  7.     format year_quarter %tq
  8. 
.     drop day date
  9. end

. 
. 
. main

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                         4,898,927  
    -----------------------------------------

    Result                           # of obs.
    -----------------------------------------
    not matched                     6,383,032
        from master                 1,008,656  (_merge==1)
        from using                  5,374,376  (_merge==2)

    matched                         3,890,271  (_merge==3)
    -----------------------------------------
(5,374,376 observations deleted)

    Result                           # of obs.
    -----------------------------------------
    not matched                       208,361
        from master                   208,361  
        from using                          0  

    matched                         4,690,566  
    -----------------------------------------

              storage   display    value
variable name   type    format     label      variable label
-------------------------------------------------------------------------------
exp_ln_mw_tot   double  %10.0g                
exp_ln_mw_ag~29 double  %10.0g                
exp_ln_mw_ag~54 double  %10.0g                
exp_ln_mw_ag~55 double  %10.0g                
exp_ln_mw_~1250 double  %10.0g                
exp_ln_mw~_3333 double  %10.0g                
exp_ln_mw~e3333 double  %10.0g                
exp_ln_mw_goo~d double  %10.0g                
exp_ln_mw_tra~l double  %10.0g                
exp_ln_mw_oth~d double  %10.0g                
exp_ln_mw_tot~n double  %10.0g                
exp_ln_m~9_mean double  %10.0g                
exp_ln_m~4_mean double  %10.0g                
exp_ln_m~5_mean double  %10.0g                
exp_ln_m~0_mean double  %10.0g                
exp_~_3333_mean double  %10.0g                
exp_~e3333_mean double  %10.0g                
exp_ln_mw_goo~n double  %10.0g                
exp_ln_mw_tra~n double  %10.0g                
exp_ln_mw_oth~n double  %10.0g                

    Result                           # of obs.
    -----------------------------------------
    not matched                       207,635
        from master                   207,635  
        from using                          0  

    matched                         4,691,292  
    -----------------------------------------

    Result                           # of obs.
    -----------------------------------------
    not matched                       207,635
        from master                   207,635  
        from using                          0  

    matched                         4,691,292  
    -----------------------------------------

    Result                           # of obs.
    -----------------------------------------
    not matched                       207,635
        from master                   207,635  
        from using                          0  

    matched                         4,691,292  
    -----------------------------------------

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
exp_ln_~t_10 |    197,978    2.120849    .1700029   1.849591   2.683324

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
exp_ln_~t_14 |    197,978    2.121163    .1699158   1.842676   2.684852

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
exp_ln_~t_17 |    197,978    2.121259    .1698576    1.81595   2.693315

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
exp_ln_~t_18 |    197,978    2.121438    .1698454   1.808574   2.699101

    Result                           # of obs.
    -----------------------------------------
    not matched                       207,635
        from master                   207,635  
        from using                          0  

    matched                         4,691,292  
    -----------------------------------------

    Result                           # of obs.
    -----------------------------------------
    not matched                       207,635
        from master                   207,635  
        from using                          0  

    matched                         4,691,292  
    -----------------------------------------

    Result                           # of obs.
    -----------------------------------------
    not matched                       207,635
        from master                   207,635  
        from using                          0  

    matched                         4,691,292  
    -----------------------------------------

    Result                           # of obs.
    -----------------------------------------
    not matched                       207,635
        from master                   207,635  
        from using                          0  

    matched                         4,691,292  
    -----------------------------------------

    Result                           # of obs.
    -----------------------------------------
    not matched                       207,635
        from master                   207,635  
        from using                          0  

    matched                         4,691,292  
    -----------------------------------------

    Result                           # of obs.
    -----------------------------------------
    not matched                        41,399
        from master                    41,399  
        from using                          0  

    matched                         4,857,528  
    -----------------------------------------
  Converting str to strL: zipcode place_code countyfips cbsa10 zcta statefips
    strcompress grew data 38% so far, but I'm not done yet!
  variable medDailylistings_NSA_SFCC was long now int
  variable Monthlylistings_NSA_SFCC was long now int
  variable NewMonthlylistings_NSA_SFCC was long now int
  variable Sale_Counts was long now int
  variable zri_MF was long now int
  variable year_month was float now int
  variable quarter was float now byte
  variable year_quarter was float now int
  variable year was double now int
  variable month was double now byte
  variable binding_mw was double now byte
  variable binding_mw_ignore_local was double now byte
  variable zipcode was strL now str5
  variable place_code was strL now str5
  variable countyfips was strL now str5
  variable cbsa10 was strL now str5
  variable zcta was strL now str5
  variable statefips was strL now str2
  (2,099,410,546 bytes saved)
       compress shrank data 31%
    strcompress shrank data  5% overall
(data now sorted by zipcode year month)
  (0 bytes saved)
===============================================================================
File: ../../../drive/derived_large/zipcode_month/zipcode_month_panel.dta
Key: zipcode year month
===============================================================================
  4898927:140(62561):3266279670:3700930780

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     zipcode |          0
        year |  4,898,927    2014.545    2.903404       2010       2020
       month |  4,898,927    6.454545    3.473632          1         12
  place_code |          0
  countyfips |          0
-------------+---------------------------------------------------------
      cbsa10 |          0
        zcta |          0
   statefips |          0
       rural |  4,898,927      .44476    .4969392          0          1
   actual_mw |  4,898,927    7.942551    1.152123       7.25      16.39
-------------+---------------------------------------------------------
actual_mw_~l |  4,898,927    7.911416    1.059949       7.25         14
actua~w_mean |  4,898,927     7.93988    1.145707       7.25      16.39
actua~l_mean |  4,898,927    7.910574    1.059235       7.25         14
  binding_mw |  4,898,927    1.478771    .5602931          1          4
binding_mw~l |  4,898,927    1.454415    .4979178          1          2
-------------+---------------------------------------------------------
medDailyli~C |    883,536    106.7855    96.75242         11       2234
medli~e_SFCC |    919,398    296524.5    256996.8      12000    6995000
m~e_low_tier |    237,537    151736.7    94283.89      11750     939935
m~e_top_tier |    481,521    463979.4    350800.1     112450    7295000
medli~t_SFCC |  1,083,813    165.6305    135.7581   11.57113   2802.347
-------------+---------------------------------------------------------
m~t_low_tier |    296,286    121.5329    83.33472   11.50727   1672.388
m~t_top_tier |    516,368    206.6456    177.9822   31.52173   2799.423
medpctpric~C |    828,016    3.957614    1.949874   .0002196   48.27586
medren~e_1BR |     69,440    1607.937     670.499        350       5195
medren~e_2BR |    106,799    1766.741    879.0102        475      19500
-------------+---------------------------------------------------------
medren~e_3BR |     76,539    1928.871     1459.31        455      40000
medren~e_4BR |     10,310    3116.339    5197.041        435      50000
medren~e_5BR |        868     5715.09    7571.906       1250      50000
medre~e_SFCC |    192,932    1768.679    1527.426        500      50000
medrent~e_CC |     34,676     2105.65    938.7924        700       8975
-------------+---------------------------------------------------------
med~e_MFdxtx |     26,880    1979.011    832.9655        375       6646
m~e_Mfr5Plus |    175,096     1554.04    697.8883        375      20000
medrent~e_SF |    142,386    1778.371    1931.017        500      50000
med~e_Studio |     28,999    1670.905    1365.808        300      50000
medren~t_1BR |     55,424    2.191226    .9194792   .6388889   7.164352
-------------+---------------------------------------------------------
medren~t_2BR |     92,792    1.682865     .803698   .5015198   12.55461
medren~t_3BR |     67,139    1.233209    .8117302   .5060225       17.5
medren~t_4BR |      8,370     1.49865    2.559936   .5492424   21.85141
medren~t_5BR |        537    7.753782    7.031498   .3727683         22
medre~t_SFCC |    197,978    1.303812    1.033133   .1091193   23.96932
-------------+---------------------------------------------------------
medrent~t_CC |     30,608    2.170225    1.168605   .5835432   12.92755
med~t_MFdxtx |     11,949    2.451649    1.286775   .3627695   6.936796
m~t_Mfr5Plus |    146,858    1.736677     .849114   .3150482   12.55435
medrent~t_SF |    144,593       1.145    1.002039   .1039069   24.48466
med~t_Studio |     23,491    1.954625    1.574804   .4288971   7.347833
-------------+---------------------------------------------------------
Monthlylis~C |    958,762    127.5251     115.849         11       2540
NewMonthly~C |    111,046    51.64428    31.47532         11        609
pctlisting~C |  1,108,016    13.15715     5.34997          0   47.94521
 Sale_Counts |  3,702,630    11.16355    19.84411          0        493
SalesPrevF~e |  2,632,281    .0325513    .1017394          0          1
-------------+---------------------------------------------------------
    zhvi_2BR |  3,011,088    148986.8    146056.2       7879    3893638
   zhvi_SFCC |  3,500,577    189281.7    191817.9       8565    6564855
      zhvi_C |  1,218,149    211001.4    177998.2      13687    3825300
     zhvi_SF |  3,496,509    197836.6    234845.9       8565    8737684
  zri_SFCCMF |  1,347,720    1356.072    875.9493        368      83894
-------------+---------------------------------------------------------
      zri_MF |    140,035    1518.065    639.5489        420      18349
exp_ln_~t_10 |  4,690,566    1.839021    .6487246          0   2.740127
exp_ln_~9_10 |  4,690,566    1.839129    .6486888          0   2.739319
exp_ln_~4_10 |  4,690,566    1.838932    .6487393          0   2.739756
exp_ln_~5_10 |  4,690,566    1.839125    .6488271          0   2.750223
-------------+---------------------------------------------------------
exp_ln_~0_10 |  4,690,566    1.839437    .6487738          0    2.74635
exp~_3333_10 |  4,690,566    1.838949    .6486037          0   2.745876
exp~e3333_10 |  4,690,566    1.838709    .6487768          0   2.735608
exp_ln~od_10 |  4,690,566    1.839335    .6486436          0   2.718174
exp_ln_~l_10 |  4,690,566    1.837919      .64824          0   2.730563
-------------+---------------------------------------------------------
exp_ln~nd_10 |  4,690,566    1.839134    .6489433          0   2.744467
exp_ln_~t_14 |  4,691,292    1.839398    .6489822          0   2.737615
exp_ln_~9_14 |  4,691,292    1.839447    .6488203          0   2.743538
exp_ln_~4_14 |  4,691,292    1.839363    .6490237          0   2.737286
exp_ln_~5_14 |  4,691,292    1.839389    .6490342          0   2.741972
-------------+---------------------------------------------------------
exp_ln_~0_14 |  4,691,292    1.839674    .6489824          0   2.738349
exp~_3333_14 |  4,691,292    1.839306    .6488387          0    2.74303
exp~e3333_14 |  4,691,292    1.839227    .6490625          0   2.739596
exp_ln~od_14 |  4,691,292    1.839656    .6486637          0   2.717228
exp_ln_~l_14 |  4,691,292    1.838368     .648356          0   2.752892
-------------+---------------------------------------------------------
exp_ln~nd_14 |  4,691,292    1.839569    .6492383          0   2.743208
exp_ln_~t_17 |  4,691,292    1.839572    .6490354          0   2.743849
exp_ln_~9_17 |  4,691,292    1.839536    .6488573          0    2.75059
exp_ln_~4_17 |  4,691,292    1.839572     .649096          0   2.744407
exp_ln_~5_17 |  4,691,292    1.839591    .6490679          0   2.746226
-------------+---------------------------------------------------------
exp_ln_~0_17 |  4,691,292    1.839653     .648907          0   2.745463
exp~_3333_17 |  4,691,292    1.839471    .6488693          0   2.737083
exp~e3333_17 |  4,691,292    1.839534    .6491811          0   2.747849
exp_ln~od_17 |  4,691,292    1.840097    .6488385          0   2.716142
exp_ln_~l_17 |  4,691,292    1.838811    .6485485          0   2.768584
-------------+---------------------------------------------------------
exp_ln~nd_17 |  4,691,292    1.839629    .6492259          0   2.746274
exp_ln_~t_18 |  4,691,292    1.839623    .6490497          0   2.745514
exp_ln_~9_18 |  4,691,292    1.839508    .6488385          0   2.755013
exp_ln_~4_18 |  4,691,292    1.839647    .6491241          0   2.745288
exp_ln_~5_18 |  4,691,292    1.839636    .6490755          0   2.746004
-------------+---------------------------------------------------------
exp_ln_~0_18 |  4,691,292    1.839636    .6488933          0   2.745401
exp~_3333_18 |  4,691,292    1.839508    .6488732          0    2.73958
exp~e3333_18 |  4,691,292    1.839646    .6492119          0   2.749908
exp_ln~od_18 |  4,691,292     1.84001    .6487694          0   2.715855
exp_ln_~l_18 |  4,691,292    1.838857    .6485969          0   2.772773
-------------+---------------------------------------------------------
exp_ln~nd_18 |  4,691,292    1.839711    .6492474          0   2.744053
exp_ln_mw~11 |  4,691,292    1.839186    .6489879          0   2.743962
exp_ln_mw~12 |  4,691,292    1.839328    .6490108          0   2.744276
exp_ln_mw~13 |  4,691,292    1.839404     .649022          0   2.747422
exp_ln_mw~15 |  4,691,292    1.839429    .6490067          0   2.739753
-------------+---------------------------------------------------------
exp_ln_mw~16 |  4,691,292    1.839422    .6490097          0   2.741767
  year_month |  4,898,927         660     34.9285        600        720
     quarter |  4,898,927    2.487603    1.121655          1          4
year_quarter |  4,898,927    219.6694    11.64445        200        240
estcount_b~v |  4,854,858    2828.751     6806.81          1      57730
-------------+---------------------------------------------------------
avgwwage_b~v |  4,854,858    948.0519    439.6974          0      26956
 emp_bizserv |  4,854,858    37473.43    93421.27          0     652629
estcount_c~t |  4,854,897    1050.896    2125.634          1      17241
avgwwage_c~t |  4,854,897    910.5299    324.5728          0       8024
   emp_const |  4,854,897    10035.88    22365.06          0     174156
-------------+---------------------------------------------------------
estcount_e~e |  4,853,139    3755.626    20496.31          1     247503
avgwwage_e~e |  4,853,139    768.9412    214.3244          0       2749
   emp_eduhe |  4,853,139    37564.41    92866.05          0     848521
estcount_f~v |  4,857,342     52.8749    68.71961          1        456
avgwwage_f~v |  4,857,342    1191.598    297.2436          0       3704
-------------+---------------------------------------------------------
  emp_fedgov |  4,857,342    5184.798    17235.49          0     215436
estcount_fin |  4,854,621     1439.22    3546.893          1      30868
avgwwage_fin |  4,854,621    1065.012    574.9054          0      12775
     emp_fin |  4,854,621    15100.81    39272.11          0     398481
estcount_i~o |  4,813,218    308.2622    1151.369          1      13783
-------------+---------------------------------------------------------
avgwwage_i~o |  4,813,218    994.9326    637.5091          0      16227
    emp_info |  4,813,218    6736.811    24994.47          0     240358
estcount_l~s |  4,855,452    1400.523    3864.234          1      40355
avgwwage_l~s |  4,855,452    331.4252     125.584          0       2473
    emp_leis |  4,855,452    26511.68    65950.63          0     555057
-------------+---------------------------------------------------------
estcount_l~v |  4,857,528    178.8089     449.871          1       4167
avgwwage_l~v |  4,857,528    760.6264     295.619          0       2104
  emp_locgov |  4,857,528    22126.78    58022.53          0     463785
estcount_m~u |  4,835,526    560.0848    1564.851          1      13469
avgwwage_m~u |  4,835,526    1015.365    427.5428          0       7592
-------------+---------------------------------------------------------
    emp_manu |  4,835,526    18152.43    47142.13          0     376653
estcount_n~s |  4,829,205    96.85127    198.2953          1       1859
avgwwage_n~s |  4,829,205     876.252    569.3159          0      23770
  emp_natres |  4,829,205    1913.936    7515.198          0      97846
estcount_s~v |  4,790,520    82.05111    355.9922          1       5969
-------------+---------------------------------------------------------
avgwwage_s~v |  4,790,520    886.4955    339.4388          0       4279
   emp_stgov |  4,790,520    6191.108    13381.62          0     114555
estcount_t~p |  4,857,453    2887.162    7098.676          1      59640
avgwwage_t~p |  4,857,453    715.4652     187.639          0      11257
  emp_transp |  4,857,453    44347.43      108598          0     875412




(note: file ../../../drive/derived_large/zipcode_month/zipcode_month_panel.dta 
> not found)
file ../../../drive/derived_large/zipcode_month/zipcode_month_panel.dta saved
(note: file ../../../drive/derived_large/zipcode_month/zipcode_month_panel.csv 
> not found)
file ../../../drive/derived_large/zipcode_month/zipcode_month_panel.csv saved

. 
end of do-file

 make.py ended: 2021-10-24 08:50:11
