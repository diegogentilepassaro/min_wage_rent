%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%                              APPENDIX                                 %%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{A dynamic supply and demand model}\label{sec:dyn_theory_model}

The geography is represented by a set of ZIP codes $\Z$.
There is an exogenously given distribution of people with differing 
residence $i$ and 
workplace $z$ locations across these ZIP codes which,
as in the main body of the paper, we denote by $\{L_{iz}\}_{i,z\in\Z\times\Z}$.

Let $H_{it}$ be the stock of square feet rented in period $t$, where $t$ is 
characterized by a month $m$ and year $y$.
This stock is composed of contracts starting at different calendar months. 
We assume that all contracts last for one year.
We impose that that $H_{it} \leq D_i$ for all $t$, 
where $D_i$ denotes the total number of available square feet in $i$.

We further decompose $H_{it}$ as follows.
Let $h_{izt} = h_{iz}\left(R_{it}, \MW_{it}, \MW_{zt}\right)$ be the 
per-person demand of housing of group $(i,z)$ in period $t$,
which depends on the prevailing MW at the time of contract sign-up.
We assume that this demand function is decreasing in residence MW and decreasing
in workplace MW, just as in Section \ref{sec:model}.
For simplicity we omitted the mediation channels of prices and income.
Let $\lambda_{it}$ denote the share of $i$'s residents who started their contracts 
in period $t$.%
\footnote{We assume that these shares do not vary by workplace.}
Then, we can write the stock of contracted square feet during period $t$ as
$$
H_{it} = \sum_{\tau = t - 11}^{t} \lambda_{i\tau} \sum_{z\in\Z} L_{iz} 
h_{iz\tau} (r_{i\tau}, \MW_{i\tau}, \MW_{z\tau})
$$
where 
$r_{i\tau}$ represents rents \textit{per square foot} in period $\tau$.
It is convenient to define the stock of contracted square feet excluding the ones 
that were signed 12 months ago. We denote them by
$$
\tilde H_{it} = \sum_{\tau = t - 10}^{t} \lambda_{i\tau} \sum_{z\in\Z} L_{iz} 
h_{iz\tau} (r_{i\tau}, \MW_{i\tau}, \MW_{z\tau}) .
$$

We assume that all square feet are homogeneous and so they have the same price in 
the market.

\subsection*{Within-period equilibrium}

Within this simple model, we assume the following timing: 
(1) At the beginning of period $t$, a share $\lambda_{it}$ of people's contracts 
expire (the ones that started on $t-12$);
(2) The square feet from expiring contracts are added to the pool of available 
rental space for new renters;
(3) Renters in $t$ and a flow supply of rental space in $t$ determine equilibrium 
rents $R_{it}$.
Let's go by these steps more formally.

As of the start of every period $t$, $\lambda_{i,t-12} \sum_z L_{iz} h_{iz,t-12}$ 
square feet become available for rent from each group of workers $(i,z)$.
The square feet available to rent in period $t$ (vacant) are then
$$
\lambda_{i,t-12} \sum_z L_{iz} h_{iz,t-12} + (D_i - H_{i,t-1}) = D_i - \tilde H_{i,t-1}.
$$
Note that $(D_i - H_{i,t-1})$ are the non-rented square feet as of $t-1$.

We denote by $V_{it}(R_{it}, \lambda_t)$ the supply of housing, increasing in 
$R_{it}$.
A feasilibity constraint is that 
\begin{equation}\label{eq:feasibility}
    V_{it}(R_{it}, \lambda_t) \leq D_i - \tilde H_{i,t-1} .
\end{equation}

The flow demand for new rentals in $t$ by those whose contract expired is given by
$$
\lambda_{it} \sum_z L_{iz} h_{izt} \left(R_{it}, \MW_{it}, \MW_{zt} \right) .
$$
This demand arises because a share of the ZIP code's contracts expired. 
Those people go to the market and may desire to rent more square feet given changes 
in their income.

The market in period $t$ cleans if
\begin{equation}\label{eq:equilibrium_dynamic}
    \lambda_t \sum_z L_{iz} h_{iz} \left(R_{it}, \MW_{it}, \MW_{zt} \right) = 
    V_{it}(R_{it}, \lambda_t) .
\end{equation}
Given minimum wages in $t$, $\{\MW_{it}\}_{i\in\Z}$,
the share of workers looking to rent in period $t$, $\lambda_t$, 
and a number of vacancies that satisfies \eqref{eq:feasibility}, 
equation \eqref{eq:equilibrium_dynamic} determines equilibrium rents in period $t$.
Because the properties of housing demand and housing supply are the same as in the
model in Section \ref{sec:model},
the equilibrium condition \eqref{eq:equilibrium_dynamic} implies an analogue of 
Propositions \ref{prop:comparative_statics} and \ref{prop:representation}.


\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Matching 2010 census geographies to USPS ZIP codes}
\label{sec:geo_crosswalk}

One challenge of this project is that data on commuting patterns and 
characteristics of places is aggregated at the level of the 2010 US Census
geographies, i.e., census blocks and census tracts.
However, our main data on rents is aggregated at the level of USPS ZIP codes,
and local minimum wage policies are defined at the level of cities.
While the different levels of 2010 census geographies are nested, they usually
overlap with USPS ZIP codes and cities.

To assign variables defined at the level of 2010 census geographies 
to USPS ZIP codes we exploit an original correspondence table between 
census blocks and USPS ZIP codes.
We construct this mapping as follows:
(1) we collect the GIS map of census blocks from \textcite{cbTiger} and 
compute their centroids
(if the centroid falls outside of the census block, 
we pick a point inside it at random);
(2) we assign the census block to a unique USPSZIP code using the GIS map 
from \textcite{ESRI} based on assigning to each census block the USPS ZIP 
code that contains its centroid.
This creates a unique mapping from census blocks to USPS ZIP codes.

To assign minimum wages defined at the level of cities to USPS ZIP codes 
we also exploit an original correspondence table, but now between 
census blocks and census designated places.
We take a MW level defined for a city to correspond to the census 
designated place of the same name.
We construct this mapping as follows:
(1) we use the census block centroids described before;
(2) we assign the census block to a unique place code using the map from 
\textcite{placeTiger} based on assigning to each census block the place 
that contains its centroid.
This creates a unique mapping from census blocks to census designated 
places.

Once we constructed these mappings, then assigning variables defined at 
any 2010 Census geography to USPS ZIP codes is straightforward.
We start by assigning the given variable to census blocks.
This can always be done as the census geographies are nested.
Then, we aggregate the variable to the USPS ZIP code level.
For count variables, such as the number of workers in LODES data, we sum.
For price variables, such as the MW, we compute weighted averages, where
weights correspond to the number of housing units in each census block 
according to the 2010 Census.
In the case of local MW provisions we exploit our original mapping 
between census blocks and census designated places to assign a local MW 
levels to each census block.
%%% SH:
%%%    Revise the numbers below
There are 11,078,297 census blocks which are assigned to 31,822 USPS ZIP codes,
implying an average of 348 census blocks per ZIP code.
%% Run `unique zipcode' in drive/base_large/census_block_master/census_block_master.dta
Thus, even though there may be census blocks that go beyond one ZIP code, 
we expect the error introduced by this process to be small.


\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Identification of first-differenced model with spillovers}
\label{sec:did_spillovers_id}

Consider the causal model for rents given by
$$r_{it}=f_{it}(\{\mw_{zt}\}_{z\in\Z})$$
where $\mw_{zt}$ represents the ``dose'' of treatment received by unit $i$ from
ZIP code $z$ in period $t$.
We say that a ZIP code $i$ is treated ``directly'' at time $t$ if $\mw_{it}>0$.
For this appendix, we think of $\Z$ as the ZIP codes in a closed metropolitan 
area. 
%% SH: To match the stacked model
Following Section \ref{sec:empirical_strategy} we assume the following functional
form for the causal model in first differences:
\begin{equation}\label{eq:causal_model}
    \Delta r_{it} = \gamma \Delta \mw_{it} 
                  + \beta \sum_{z\in\Z} \pi_{iz} \Delta \mw_{zt}
                  + \delta_t + \Delta \varepsilon_{it}
\end{equation}
where $\delta_t$ is a time effect,
$\Delta \varepsilon_{it}$ stands for other factors that determine the evolution
of rents in ZIP code $i$, and
other objects are defined as in the paper.
We show that the parameters $\beta$ and $\gamma$ can be recovered from data on 
rent changes and minimum wage changes under suitable parallel-trends 
assumptions.

\begin{prop}[Identification]\label{prop:did_id}
    Consider a policy such that, 
    for some (directly treated) ZIP codes  $z\in\Z_0\subset\Z$ for non-empty $\Z_0$,
        $\Delta\mw_{zt}=\Delta\mw>0$ if $t=\bar{t}$ and
        $\Delta\mw_{zt}=0$           if $t\neq\bar{t}$,
    and for (not directly treated) ZIP codes $z\notin\Z_0$ ,
        $\Delta\mw_{zt}=0$ for all $t$.
    Assume
    (1) there exist at least two not directly treated ZIP codes with differential 
    exposure to the policy, 
    (2) parallel trends among two non-empty subgroups of not directly treated 
    ZIP codes (specified below),
    (3) parallel trends across directly treated ZIP codes and not directly 
    treated ZIP codes.
    Then, the parameters $\beta$ and $\gamma$ in the structural model 
    \ref{eq:causal_model} are identified.
\end{prop}

\begin{proof}
    The expected evolution of rents in ZIP codes not treated directly is
    \begin{equation}\label{eq:expected_rents_nottreated}
        E[\Delta r_{it} | i\notin\Z_0] = 
        \begin{cases}
            \delta_t + E[\Delta \varepsilon_{it} | z\notin\Z_0] 
                                       & \text{ if } t\neq\bar{t} \\
            \beta\sum_{z\in\Z_0}\pi_{iz}\mw_{zt} + \delta_t 
                     + E[\Delta \varepsilon_{it} | z\notin\Z_0] 
                                       & \text{ if } t=\bar{t} ,
        \end{cases}
    \end{equation}
    Now, rank theese ZIP codes according to their exposure to the policy 
    $\Pi_i = \sum_{z\in Z_0} \pi_{iz}$.
    Consider a partition of ZIP codes in $\Z\setminus\Z_0$ in 
    two non-empty subsets such that 
    ZIP codes with $\Pi_i > \bar\Pi$ belong to a ``high exposure'' group $\Z_h$, 
    and the rest to a ``low exposure'' group $\Z_l$,
    where $\bar\Pi\in\left(\min{\Pi_i}, \max{\Pi_i}\right)$.
    Using \ref{eq:expected_rents_nottreated} we can compute, for $t\neq \bar{t}$,
    \begin{equation*}
        E[\Delta r_{it} | i\in\Z_h] - E[\Delta r_{it} | i\in\Z_l] = 
        E[\Delta \varepsilon_{it} | i\in\Z_h] - E[\Delta \varepsilon_{it} | i\in\Z_l] ,
    \end{equation*}
    and for $t = \bar{t}$,
    \begin{equation*}
        \begin{split}
            E[\Delta r_{it} | i\in\Z_h] - E[\Delta r_{it} | i\in\Z_l] 
            & = \beta \left(E\left[\sum_{z\in\Z_0}\pi_{iz} \Big| i\in\Z_h\right]
                           - E\left[\sum_{z\in\Z_0}\pi_{iz} \Big| i\in\Z_l\right]\right) \Delta \mw  \\
            & + E[\Delta \varepsilon_{it} | i\in\Z_h] - E[\Delta \varepsilon_{it} | i\in\Z_l] .
        \end{split}
    \end{equation*}
    Under assumption (2), namely that 
    $E[\Delta \varepsilon_{it} | i\in\Z_h] 
     - E[\Delta \varepsilon_{it} | i\in\Z_l] = 0$,
    we can re-arrange the previous equation to obtain
    \begin{equation}\label{eq:id_beta}
        \beta = \frac{E[\Delta r_{it} | i\in\Z_h] - E[\Delta r_{it} | i\in\Z_l]}
                     {\left(E[\sum_{z\in\Z_0}\pi_{iz} | i\in\Z_h] - E[\sum_{z\in\Z_0}\pi_{iz} | i\in\Z_l]\right) \Delta \mw}.
    \end{equation}
    Assumption (1) guarantees that 
    $\left(E[\sum_{z\in\Z_0}\pi_{iz} | i\in\Z_h] 
          - E[\sum_{z\in\Z_0}\pi_{iz} | i\in\Z_l]\right) \neq 0$,  
    thus $\beta$ is identified.

    For those ZIP codes that are treated directly, the expected evolution of 
    rents is
    \begin{equation*}\label{eq:expected_rents_treated}
        E[\Delta r_{it} | i\in\Z_0] = 
        \begin{cases}
            \delta_t + E[\Delta \varepsilon_{it} | z\notin\Z_0] 
                                       & \text{ if } t\neq\bar{t} \\
            \gamma\Delta\mw + \beta\sum_{z\in\Z_0}\pi_{iz}\Delta\mw + \delta_t 
                     + E[\Delta \varepsilon_{it} | z\notin\Z_0] 
                                       & \text{ if } t=\bar{t} .
        \end{cases}
    \end{equation*}
    Differencing with respect to \ref{eq:expected_rents_nottreated} obtains, 
    for $t=\bar{t}$,
    \begin{equation*}
        \begin{split}
            E[\Delta r_{it} | i\in\Z_0] - E[\Delta r_{it} | i\notin\Z_0] 
              & = \gamma \Delta \mw  \\
              & + \beta \left(E\left[\sum_{z\in\Z_0}\pi_{iz} \Big| i\in\Z_0\right]
                           - E\left[\sum_{z\in\Z_0}\pi_{iz} \Big| i\notin\Z_0\right]\right) \Delta \mw  \\
              & + E[\Delta \varepsilon_{it} | i\in\Z_0] - E[\Delta \varepsilon_{it} | i\notin\Z_0] .
        \end{split}
    \end{equation*}
    Assumption (3) means that
    $E[\Delta \varepsilon_{it} | i\in\Z_0] 
      - E[\Delta \varepsilon_{it} | i\notin\Z_0] = 0$.
    Substituting in the previous equation yields
    \begin{equation}\label{eq:id_gamma}
        \gamma = \frac{E[\Delta r_{it} | i\in\Z_0] - E[\Delta r_{it} | i\notin\Z_0]}{\Delta\mw}
            - \beta \left(E\left[\sum_{z\in\Z_0}\pi_{iz} \Big| i\in\Z_0   \right] 
                        - E\left[\sum_{z\in\Z_0}\pi_{iz} \Big| i\notin\Z_0\right]\right) .
    \end{equation}
    Since $\beta$ is known per equation \ref{eq:id_beta}, $\gamma$ is identified
    as well.
\end{proof}

